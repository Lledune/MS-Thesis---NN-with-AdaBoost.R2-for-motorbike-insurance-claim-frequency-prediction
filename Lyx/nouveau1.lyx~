#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{algorithm}
\usepackage{algorithmic}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize a4paper
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Adaboost for Neural networks applied to an insurance Database
\end_layout

\begin_layout Author
Lucien Ledune
\end_layout

\begin_layout Date
16 april 2019
\begin_inset Newpage newpage
\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Abstract
This will be the abstract of the document
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Partout dans le monde, la facilité montante de l'accès à une puissance de
 calcul importante a motivé un grand nombre de changement dans la façon
 d'approcher les problèmes, et ce dans la plupart des domaines de recherche.
 Cette avancée technologique a permi d'utiliser des techniques de modélisations
 et de prédictions qui étaient jusqu'à lors trop longues à mettre en place
 pour avoir un réel intérêt pratique.
 Le secteur des assurances n'a pas été épargné par le phénomène et évolue
 avec son temps.
 Le machine learning
\begin_inset Foot
status open

\begin_layout Plain Layout
Apprentissage automatique : Méthodes statistique permettant à un ordinateur
 d'apprendre à résoudre un problème donné à l'aide d'une base de données
 pertinente.
\end_layout

\end_inset

, outil de modélisation très puissant, est maintenant facilement accessible
 et les compagnies d'assurances souhaient en tirer le meilleur parti en
 matière de prédiction et d'aide à la décision.
 
\begin_inset Newline newline
\end_inset

La modélisation de prédiction n'est pas nouvelle dans ce secteur, mais les
 algorithmes utilisés changent avec l'essort actuel de la technologie.
 Ainsi nous pouvons maintenant facilement utiliser des réseaux de neurones
 afin de répondre aux problèmes pour lesquels des algorithmes moins efficaces
 étaient utilisés.
 Le but de ce travail est de montrer que ces nouveaux
\begin_inset Foot
status open

\begin_layout Plain Layout
La plupart de ces algorithmes sont en fait assez peu récents mais étaient
 difficilement applicables en raison d'une puissance de calcul trop faible,
 citons par exemple le perceptron, élement de base des réseaux de neurones
 qui a été inventé dès 1957.
\end_layout

\end_inset

 algorithmes sont efficaces et représentent un espoir d'amélioration pour
 le futur.
 TODO : expliquer le mémoire rapidement.
\end_layout

\begin_layout Section
Dataset
\end_layout

\begin_layout Subsection
Présentation des données
\end_layout

\begin_layout Standard
Afin de réaliser ce travail, nous avons besoin d'une base de donnée adéquate,
 nous présentons celle-ci dans cette sous-section.
 La base de données est constituée d'informations sur les clients d'une
 compagnie d'assurance nommée Wasa, entre 1994 et 1998.
 Les véhicules assurées sont composés uniquement de motos.
 Il est difficile d'obtenir des données plus récentes à cause des clauses
 de confidentialité des assurances.
 La version originelle de ce jeu de données est utilisée dans une étude
 cas du livre 
\begin_inset Quotes eld
\end_inset

Non-life insurance pricing with GLM
\begin_inset Quotes erd
\end_inset

, écrit par Ohlsson et Johansson, et celle-ci est disponible sur le site
 web du livre
\begin_inset Foot
status open

\begin_layout Plain Layout
http://staff.math.su.se/esbj/GLMbook/case.html
\end_layout

\end_inset

.
 Le jeu de données est constitué de 64505 observations des 9 variables suivantes
 :
\end_layout

\begin_layout Itemize
OwnersAge : L'âge du conducteur.
\end_layout

\begin_layout Itemize
Gender : Le sexe du conducteur.
\end_layout

\begin_layout Itemize
Zone : Variable catégorielle représentant la zone dans laquelle le véhicule
 est conduit..
\end_layout

\begin_layout Itemize
Class : Variable catégorielle représentant la classe du véhicule.
 Les classes sont assignées dans une des 7 catégories selon le ratio : 
\begin_inset Formula $EV=\frac{kW\times100}{kg+75}$
\end_inset

.
\end_layout

\begin_layout Itemize
VehiculeAge : L'âge du véhicule en années.
\end_layout

\begin_layout Itemize
BonusClass : Le bonus du conducteur, un nouveau conducteur commence à 1
 et sera incrémenté à chaque année complète passée dans la compagnie sans
 sinistre déclaré, jusqu'à un maximum de 7.
\end_layout

\begin_layout Itemize
Duration : Le nombre d'année passées dans la compagnie.
\end_layout

\begin_layout Itemize
NumberClaims : Le nombre de sinistres.
\end_layout

\begin_layout Itemize
ClaimCost : Le coût des sinistres.
\end_layout

\begin_layout Standard
La variable Zone est décrite dans la table 1.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Descriptions des variables catégorielles
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="3">
<features booktabs="true" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="left" valignment="top" width="5cm">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Variable
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Classe
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Zone géographique
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parties centrales et semi-centrales des trois plus grandes villes de Norvège.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Banlieues et villes moyennes.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Petites villes (à l'exception de celles des catégories 5 et 7).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Villages (à l'exception de ceux des catégories 5 et 7).
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Villes du nord de la Suède.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Campagnes du nord de la Suède.
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Gotland (Grande île).
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Analyse exploratoire
\end_layout

\begin_layout Standard
Maintenant que les différentes variables ont été brièvement présentées et
 leur fonction plus claire, nous allons maintenant passer à l'analyse exploratoi
re de celles-ci.
 Le but de cette analyse est de mieux comprendre les données qui serviront
 à entraîner les différents algorithmes, ainsi que de repérer d'éventuelles
 anomalies.
 Durant l'analyse exploratoire d'une base de données, il est important de
 regarder la distribution des variables, celle-ci nous donne beaucoup d'informat
ions quant aux données.
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/gender2.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution Gender
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/ownerage.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution OwnersAge
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Sur ces deux premières figures nous observons respectivement les distributions
 des variables Gender et OwnersAge.
 La première chose que nous pouvons observer est la grande disparité entre
 le nombre d'hommes de et femmes clients de l'assurance.
 Notre jeu de données est composé d'hommes pour la grande majorité.
 Pour ce qui est de la variable OwnersAge, nous constatons que les valeurs
 sont réparties entre 16 et 92 ans, avec deux 
\begin_inset Quotes eld
\end_inset

pics
\begin_inset Quotes erd
\end_inset

 vers 25 et 45 ans.
 Les valeurs maximales et minimales de nos variables continues seront importante
 pour la suite, car elles sont nécessaires afin d'appliquer une normalisation
 des données, qui sera discutée plus tard dans ce travail.
 Ci dessous les distributions des variables VehiculeAge et Zone : 
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/vehiculeage.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution VehiculeAge
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/zone.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution Zone
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

La distribution de vehicule est indiquée en années, et nous pouvons donc
 observer que si la plupart des véhicules assurés ont moins de 20 ans, un
 grand nombre de ceux-ci sont bien plus vieux, avec comme maximum 99 ans.
 Il est possible que ce véhicule soit considéré comme outlier et il sera
 reconsidéré dans la partie preprocessing.
\begin_inset Newline newline
\end_inset

La distribution de la variable Zone est intéressante, elle nous révèle que
 la plupart des véhicules assurés sont conduits dans des villages, mais
 aussi que très peu d'entre eux le sont dans le Gotland.
 Ceci n'est pas surprenant puisque la population de la Suède est d'environ
 10 millions d'habitants, pour seulement 60.000 habitants la région du Gotland.
 Les classes 5 et 6 sont elles aussi minoritaires, cela était aussi à prévoir
 puisque ces catégories représentent le nord de la Suède alors que la plupart
 de la population vis dans le sud du pays.
 
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/bonus.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution BonusClass
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/class.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution Class
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Les classes de bonus les plus fréquentes sont les classes 1 et 7, respectivement
 le minimum (entrée dans la compagnie d'assurance) et le maximum (client
 fidèle depuis sept années au minimum).
 
\begin_inset Newline newline
\end_inset

Pour la variable Class nous observons qu'assez peu de véhicules appartiennent
 à la catégorie la plus puissante.
 En fait, la plupart des véhicules se situent dans les classes 3, 4 et 5,
 ce qui montre que les vehicules les moins puissants et les plus puissants
 sont minoritaires.
 Les graphiques suivants nous montrent la répartitions des sinistres par
 bonus et par classe de véhicule.
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/BonusClaim.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Bonus Claims
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/ClassClaim.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Class Claims
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

Il parait logique de supposer que plus un client a un bonus élevé, moins
 celui-ci causera d'accident, puisque le bonus monte uniquement si le client
 parvient à compléter une année sans causer d'accident.
 Cependant en observant la figure 7, il apparait que la majorité des cas
 d'accidents sont déclarés par des clients appartenant aux classes 3 à 6
 de bonus.
 Ce qui est d'autant plus étonnant lorsque l'on associe ce résultat avec
 la distribution de la variable Class (figure 5) : les classes 3 à 6 sont
 celles contenant le moins d'utilisateurs.
 Les clients appartenant à la classe de bonus 7 semblent cependant causer
 très peu d'accidents malgré le fait qu'ils soient la classe de bonus majoritair
e.
\begin_inset Newline newline
\end_inset

Les résultats de la figure 8 sont moins surprenant : plus un véhicule est
 puissant, plus le risque d'accident sera important.
 Les déviations de cette régle par les classes 3 et 7 sont expliquées par
 la distribution de la population à travers les différentes classes (figure
 6), ainsi il y a peu d'accidents pour les véhicules de classe 7 simplement
 car ceux-ci sont peu nombreux, une conclusion similaire peut être énoncée
 pour la classe 3.
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/genderClaim.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Gender claims
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/zoneClaim.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Zone claims
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

La répartition des sinistres par sexe indique que les hommes sont plus suceptibl
es de causer des accidents que les femmes.
 Il faut prendre en compte que les hommes sont bien plus nombreux que les
 femmes dans nos données, mais la conclusion ne change pas puisque la proportion
 de femmes est de 18%, alors que celles-ci ne causent que 8.7% des sinistres.
 Sur la figure 10, nous observons que les classes 1 et 3 sont celles qui
 déclarent le plus de sinistres.
 La première classe étant plutôt minoritaire (figure 4) nous observons que
 les personnes habitant dans les parties centrales et semi-centrales de
 Norvège semblent causer bien plus d'accidents que les autres catégories,
 la même conclusion peut être faite pour la deuxième classe (Banlieues et
 villes moyennes).
 Pour ce qui est de nord de la Suède, nous constatons l'inverse puisque
 ceux-ci semblent causer assez peu d'accidents.
\begin_inset Newline newline
\end_inset


\begin_inset Float figure
placement !h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/MvFclaims.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Gender claims by Age
\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/claimcost2.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Distribution ClaimCost
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

La figure 11 a pour but de mieux comprendre cette disparité entre les hommes
 et les femmes dans la déclaration des sinistres.
 Une comparaison par âge permet de mettre en évidence une information importante.
 En effet, si les hommes semblent bien causer plus d'accidents que les femmes
 jusqu'à la treintaine, cette tendance s'égalise passé ce cap.
 Enfin, la figure 12 nous informe de la distribution de la variable ClaimCost,
 représentant le coût total des sinistres d'un client.
 Il est important de noter qu'il s'agit bien de la somme de tous les sinistres
 déclarés du client, ainsi si une personne a reçu une compensation de l'assuranc
e pour plusieurs sinistres, la variable contient la somme du coût de tous
 ces sinistres déclarés.
 Il semble que la grande majorité des clients ne dépassent pas 5000€ de
 compensation venant de l'assurance (Le graphique ne montre que les valeurs
 non-nulles, ainsi les clients n'ayant jamais déclaté de sinistres ne sont
 pas comptés dans l'intervalle 
\begin_inset Formula $\left[0,5000\right]$
\end_inset

.
 La distribution de cette variable montre bien qu'assez peu de clients dépassent
 les 20.000€ de compensation, mais certains peuvent monter à près de 200.000€.
\end_layout

\begin_layout Subsection
Assurances
\end_layout

\begin_layout Standard
Dans cette sous-section seront expliquées les particularités de l'analyse
 de données dans le cadre de l'assurance, et plus précisement dans le cas
 qui nous intéresse ici.
\end_layout

\begin_layout Subsubsection
Principe
\end_layout

\begin_layout Standard
Un contrat entre l'assureur et l'assuré implique le payement d'une prime
 d'assurance par le second, en échange de compensations lorsqu'un sinistre
 est déclaré.
 Le fait de regrouper un grand nombre de clients va avoir un effet stabilisateur
 de variance pour l'assureur.
 En effet il est difficile de prédire précisemment le nombre d'accidents
 qu'un assuré aura, cependant plus le nombre d'assurés sera élevé et plus
 le nombre (total) de sinistres sera prévisible.
 Ceci est du à la loi des grands nombres qui implique :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\bar{X}\rightarrow\mu\:when\,n\rightarrow\infty
\]

\end_inset


\begin_inset Newline newline
\end_inset

La moyenne de l'échantillon 
\begin_inset Formula $\bar{X}$
\end_inset

converge vers le moyenne de la population 
\begin_inset Formula $\mu$
\end_inset

 lorsque la taille de l'échantillon augmente.
 
\begin_inset Newline newline
\end_inset

Dans le cadre de l'assurance, les variables explicatives sont aussi appelées
 facteur d'évaluations, les deux termes seront utilisés indifférement au
 cours de ce travail.
\end_layout

\begin_layout Subsubsection
Ratio
\end_layout

\begin_layout Standard
Il est important de comprendre ce que l'on cherche à expliquer avec un modèle,
 aussi il faut savoir que cette analyse se base sur un ratio.
 Un ratio 
\begin_inset Formula $Y$
\end_inset

 est un rapport entre une réponse 
\begin_inset Formula $X$
\end_inset

 et une exposition
\begin_inset Foot
status open

\begin_layout Plain Layout
L'exposition peut être le nombre de sinistres ou la durée du contrat.
\end_layout

\end_inset

 
\begin_inset Formula $v$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Y=X/v
\]

\end_inset


\begin_inset Newline newline
\end_inset

Il existe différents ratios mais ici ne sera présenté que celui utilisé
 dans l'analyse à venir : La fréquence des réclamations.
 Il s'agit du rapport entre le nombre de réclamations et la durée du contrat,
 nous obtenons ainsi une fréquence qui sera la variable prédite par nos
 modèles.
\end_layout

\begin_layout Subsubsection
Distribution du ratio
\end_layout

\begin_layout Standard
Pour la création d'un modèle cherchant à prédire la fréquence des réclamations
 c'est souvent la distribution Poisson qui est utilisée.
 Une loi poisson de paramètre 
\begin_inset Formula $\lambda$
\end_inset

 implique :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Y\sim Poisson(\lambda)
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E[Y]=\lambda
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Var[Y]=\lambda
\]

\end_inset


\begin_inset Newline newline
\end_inset

Afin de vérifier que la distribution de la fréquence des sinistres suit
 bien une loi de poisson celle-ci est affichée.
 En effet la plupart des valeurs se situent près de 0, les valeurs supérieures
 à 1 sont présentes mais extrêmement rares et ne sont donc pas affichées
 afin d'observer plus précisemment les valeurs types.
\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Graphics
	filename C:/Users/Lucien/Desktop/Poisson-neural-network-insurance-pricing/R/plots/Rplot02.png
	width 6cm
	height 4.5cm
	keepAspectRatio

\end_inset


\begin_inset Newline newline
\end_inset

La loi de poisson fait partie de la famille des modèles à dispersion exponentiel
le (ED), une catégorie regroupant un grand nombre de lois statistiques connues
 comme la loi normale, gamma ou encore binomiale.
 Une variable aléatoire Y suit une dispersion exponentielle si sa fonction
 de distribution suit la forme suivante :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
f_{Y_{i}}(y;\theta_{i};\phi)=exp\left\{ \frac{y\theta_{i}-a(\theta_{i})}{\phi/v_{i}}\right\} c(y,\phi,v_{i})
\]

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $\theta_{i}$
\end_inset

: paramètre dépendant de i.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\phi$
\end_inset

: paramètre identique pour tous les i.
 C'est le paramètre de dispersion
\end_layout

\begin_layout Itemize
\begin_inset Formula $c(.)$
\end_inset

 est indépendante du paramètre 
\begin_inset Formula $\theta_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Preprocessing
\end_layout

\begin_layout Standard
Le preprocessing des données est une étape très importante lorsque nous
 travaillons avec ce type de données et celui-ci n'est pas à négliger.
 Il consiste a préparer les données pour les algorithmes, afin que ceux-ci
 puissent fonctionner de manière optimale.
 Dans ce travail, plusieurs méthodes de preprocessing ont été utilisées.
\end_layout

\begin_layout Subsubsection
Variables binaires (Dummy variables)
\end_layout

\begin_layout Standard
Certaines de nos variables sont catégorielles, et plus particulièrement
 sont des variables non-ordinales.
 Cela signifie que les différentes catégories ne peuvent pas être ordonnées,
 il s'agit purement de l'assignation d'un client à un groupe donné.
 Ce type de variable ne peut pas être encodé tel quel et doit être transformé
 en une série de variables binaires.
 La conversion d'une variable catégorielle en variable binaire consiste
 à créer 
\begin_inset Formula $n-1$
\end_inset

 nouvelles variables dites 
\begin_inset Quotes eld
\end_inset

binaires
\begin_inset Quotes erd
\end_inset

 et qui prendront pour valeur 
\begin_inset Formula $1$
\end_inset

 si le client appartient à cette catégorie, 
\begin_inset Formula $0$
\end_inset

 sinon.
 Par exemple si 
\begin_inset Formula $x_{ij}$
\end_inset

 représente la variable associée au client 
\begin_inset Formula $i$
\end_inset

 et à la variable 
\begin_inset Formula $j$
\end_inset

, nous pouvons écrire :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
x_{ij}=\begin{cases}
0\text{ if }x_{i}\notin j & 1\text{ if }x_{i}\in j\end{cases}
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset

Les variables Gender, Zone, Class, et BonusClass peuvent être transformées
 de la sorte.
 Ce travail sera effectué avec le package caret
\begin_inset Foot
status open

\begin_layout Plain Layout
Classification And REgression Tools : Package de machine learning pour R.
\end_layout

\end_inset

 de R.
 La fonction incluse dans ce package crée 
\begin_inset Formula $n$
\end_inset

 variables binaires, la dernière sera donc supprimée car celle-ci ne représente
 aucune information.
 Prenons pour exemple la variable Gender.
 Si 
\begin_inset Formula $x_{iGender}=1$
\end_inset

 alors le client est une femme.
 Cependant nous ne devons pas créer une deuxième variable binaire puisque
 si 
\begin_inset Formula $x_{iGender}=0$
\end_inset

 nous pouvons en déduire que le client est un homme.
 Ceci explique pourquoi nous n'avons besoin que de 
\begin_inset Formula $n-1$
\end_inset

 variables binaires pour représenter toute l'information de 
\begin_inset Formula $n$
\end_inset

 catégories appartenant à une variable catégorielle.
\end_layout

\begin_layout Subsubsection
Normalisation
\end_layout

\begin_layout Standard
Les données quantitatives ne doivent pas être transformées en variables
 binaires (bien que celles-ci peuvent être converties en intervalles puis
 en variables binaires, ce ne sera pas le cas dans le cadre de ce travail).
 Cependant cela ne signifie pas qu'aucune méthode de preprocessing ne doit
 être appliquée à ces données.
 La normalisation des données quantitatives aide certains algoithmes à converger
 plus rapidement et peut même parfois améliorer leur précision.
 Cette normalisation des données est particulièrement importante pour les
 réseaux de neurones, car l'optimisation de ceux-ci est basée sur les résultats
 des fonctions d'activation
\begin_inset Foot
status open

\begin_layout Plain Layout
Voir chapitre 3
\end_layout

\end_inset

 utilisées.
 Celles-ci varient rapidement entre 0 et 1 (ou -1 et 1) et sans la normalisation
 des données leurs réponses aux valeurs extrêmes seraient localisées dans
 les extrémités, ce qui peut empêcher l'algorithme de converger dans les
 cas les plus graves.
\begin_inset Newline newline
\end_inset

Plusieurs méthodes peuvent être utilisées afin de procéder à la normalisation
 des données.
 Cependant nous ne décrirons que celle qui sera utilisée dans le cadre de
 ce travail : la normalisation Min Max.
 
\begin_inset Newline newline
\end_inset

Elle consiste (pour une variable 
\begin_inset Formula $j$
\end_inset

) à convertir l'ensemble des données sur l'intervalle 
\begin_inset Formula $[\text{0,1]}$
\end_inset

en se servant de 
\begin_inset Formula $Max(x_{j})$
\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Valeur maximale prise par la variable j.
\end_layout

\end_inset

 et 
\begin_inset Formula $Min(x_{j})$
\end_inset


\begin_inset Foot
status open

\begin_layout Plain Layout
Valeur minimale prise par la variable j.
\end_layout

\end_inset

 par la formule : 
\begin_inset Newline newline
\end_inset


\begin_inset Formula 
\begin{align*}
z_{ij} & =\frac{x_{ij}-min(x_{j})}{max(x_{j})-min(x_{j})}
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset

Cette transformation sera appliquée aux variables OwnersAge et VehiculeAge.
\end_layout

\begin_layout Subsubsection
Outliers
\end_layout

\begin_layout Standard
Lors de l'encodage des données, il arrive que certaines valeurs des variables
 quantitatives soient assez extrêmes et semblent fort distantes des autres
 observations.
 Dans ce cas nous pouvons soit garder la valeur si celle-ci semble ajouter
 de l'information au modèle ou la supprimer dans le but d'une meilleure
 généralisation par celui-ci.
 Dans la section 2.2 une donnée a particulièrement attiré notre attention
 comme outlier potentiel : une moto de 99 ans.
 Pour celle-ci nous pouvons entrevoir deux possibilités :
\end_layout

\begin_layout Itemize
Il peut simplement s'agir d'une erreur d'encodage, auquel cas l'observation
 doit être supprimée pour éviter de biaiser le modèle.
\end_layout

\begin_layout Itemize
Il peut également s'agir d'une vraie moto de type 
\begin_inset Quotes eld
\end_inset

ancêtre
\begin_inset Quotes erd
\end_inset

, cependant ce genre de véhicule ne se conduit pas de la même manière qu'un
 véhicule utilisé au quotidien, et on peut supporser que les risques d'accidents
 sont bien moindres.
 Dans ce cas-ci la suppression de la donnée n'est pas obligatoire mais peut
 aider à une meilleure généralisation du modèle.
\end_layout

\begin_layout Standard
Puisqu'aucun moyen simple de vérifier cette hypothèse n'est disponible,
 celle-ci sera supprimée de la base de donnée car la perte d'information
 est moindre.
\begin_inset Newline newline
\end_inset

La suppression de trop d'information peut cependant nuire au modèle, les
 données extrêmes mais non-aberantes seront donc conservées.
\end_layout

\begin_layout Subsubsection
Durée de contrat
\end_layout

\begin_layout Standard
Pour le bon fonctionement du modèle, certaines autres données ont du être
 modifiées car celles-ci entrainaient des erreurs dans la fonction de déviance
 utilisée pour la calibration des poids des réseaux de neurones.
 Les observations incriminées sont celles ayant une durée de contrat nulle.
 Ces valeurs nulles de durée de contrat sont peu cohérentes (impossible
 d'avoir un sinistre déclaré au cours du contrat si celui-ci n'est pas encore
 en vigueur) et elles seront donc changées par la valeur correspondant à
 un jour (
\begin_inset Formula $1/365\simeq0.00274$
\end_inset

).
 Certaines de ces observations n'ont cependant pas une valeur nulle pour
 la variable NbClaims, ce qui signifie que des sinistres auraient été déclarés
 dans des contrats dont la durée est nulle.
 Ce cas de figure n'étant pas possible, elles seront supprimées car il s'agit
 probablement d'erreur d'encodage.
 De plus changer la valeur de la durée du contrat par 0.00274 dans ce cas
 reviendrait à considérer une fréquence de sinistre de 
\begin_inset Formula $\simeq365$
\end_inset

 soit un sinistre par jour ce qui pourrait grandement biaiser le modèle.
\end_layout

\begin_layout Section
Algorithmes
\end_layout

\begin_layout Standard
Dans cette section, les différents algorithmes utilisés lors des analyses
 seront présentés à des fins de compréhension du travail.
 ..............................
\begin_inset Newline newline
\end_inset

Afin d'effectuer un travail de prédiction en matière de régression ou de
 classification, il est nécessaire d'avoir un outil puissant à disposition
 : l'apprentissage automatique ou 
\begin_inset Quotes eld
\end_inset

machine learning
\begin_inset Quotes erd
\end_inset

.
 Il s'agit d'un ensemble de méthodes basées sur des outils statistiques
 permettant la création de modèles pouvant être utilisés pour la prédiction.
 (réf wiki)
\end_layout

\begin_layout Subsection
Explication d'un modèle
\end_layout

\begin_layout Subsubsection
Définitions et apprentissage
\end_layout

\begin_layout Standard
Avant de pouvoir rentrer dans les détails, il est important de définir les
 notations qui seront utilisées, de définir ce qu'est un modèle et comment
 celui-ci se construit.
 La construction d'un modèle est spécifique pour la résolution d'une tâche
 
\begin_inset Formula $T$
\end_inset

, que l'on cherche à améliorer par rapport à une métrique 
\begin_inset Formula $P$
\end_inset

 grâce à des expériences
\begin_inset Foot
status open

\begin_layout Plain Layout
Données.
\end_layout

\end_inset

 
\begin_inset Formula $Q$
\end_inset

.
 La base de données est composée de 
\begin_inset Formula $X$
\end_inset

 les variables explicatives et de 
\begin_inset Formula $Y$
\end_inset

 la variable expliquée.
 Dans notre cas :
\end_layout

\begin_layout Itemize
\begin_inset Formula $T$
\end_inset

 : Déterminer la fréquence des sinistres.
\end_layout

\begin_layout Itemize
\begin_inset Formula $P$
\end_inset

 : Déviance (Explications dans la section 3.1.2).
\end_layout

\begin_layout Itemize
\begin_inset Formula $Q=\{(x_{1},y_{1}),...,(x_{n},y_{n})\}$
\end_inset

 : Base de données 
\begin_inset Formula $X\rightarrow Y$
\end_inset


\end_layout

\begin_layout Standard
Un modèle cherche à approximer une fonction cible (choisie), dans le cas
 étudié 
\begin_inset Formula $f:X\rightarrow\mathbb{R^{+}}$
\end_inset


\begin_inset Newline newline
\end_inset

Dans notre étude seuls les modèles supervisés
\begin_inset Foot
status open

\begin_layout Plain Layout
Algorithmes nécessitant une base de données 
\begin_inset Formula $X\rightarrow Y$
\end_inset

 pour l'apprentissage.
\end_layout

\end_inset

 seront abordés.
 Deux éléments sont nécessaires pour la création d'un modèle, une base de
 données et un algorithme supervisé (choix du modèle).
 La base de données est composée de 
\begin_inset Formula $N$
\end_inset

 entrées des variables explicatives et de la variable expliquée 
\begin_inset Formula $y_{i}$
\end_inset

 où 
\begin_inset Formula $i$
\end_inset

 représente l'individu et où 
\begin_inset Formula $x_{ij}$
\end_inset

 représente la valeur prise pour la variable 
\begin_inset Formula $j$
\end_inset

 pour l'individu 
\begin_inset Formula $i$
\end_inset

.
 Le modèle va se servir des valeurs prises par les 
\begin_inset Formula $x_{ij}$
\end_inset

 pour tenter d'expliquer 
\begin_inset Formula $y_{i}$
\end_inset

.
 Pour ce faire l'algorithme doit subir une phase d'apprentissage, aucours
 de laquelle celui-ci va recevoir des entrées provenant de la base de données
 et se servir de celles-ci pour 
\begin_inset Quotes eld
\end_inset

apprendre
\begin_inset Quotes erd
\end_inset

 et se calibrer sur le problème que l'on cherche à résoudre.
 Cette phase d'apprentissage est différente d'un algorithme à un autre.
 Une fois cette phase d'apprentissage terminée le modèle ainsi créé peut
 être utilisé pour la prédiction (après que celui-ci ait été validé, voir
 sous-sections suivantes).
 Les valeurs prédites par l'algorithmes seront notées 
\begin_inset Formula $\hat{y_{i}}$
\end_inset

.
\end_layout

\begin_layout Subsubsection
Évaluation
\end_layout

\begin_layout Standard
Pour l'apprentissage, les algorithmes supervisés se basent sur un critère
 mesurant l'erreur d'un modèle : la fonction de perte.
 Ce critère permet la comparaison entre différents modèles et un choix optimal
 parmis ceux-ci, en sélectionnant celui qui minimise l'erreur commise dans
 les prédictions.
 Il existe un grand nombre de critères pouvant servir pour l'évaluation
 des modèles mais le choix de celui-ci doit se faire en fonction du problème
 adressé et de la base de données.
 Le choix de ce critère est important car il peut impacter l'efficacité
 des modèles créés.
\begin_inset Newline newline
\end_inset

Le critère peut être défini comme 
\begin_inset Formula $f(y,\hat{y})$
\end_inset

 une fonction dépendant des valeurs prises par 
\begin_inset Formula $y$
\end_inset

 et 
\begin_inset Formula $\hat{y}$
\end_inset

 mesurant la différence entre les prédictions et la réalité d'une certaine
 manière.
 (https://en.wikipedia.org/wiki/Loss_function) Une fonction de perte intuitive
 est donnée en guise d'example par la racine de l'erreur quadratique moyenne
 (RMSE).
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
RMSE(\theta,\hat{\theta})=\sqrt{MSE(\theta,\hat{\theta})}=\sqrt{E((\hat{\theta}-\theta)^{2})}
\]

\end_inset


\begin_inset Newline newline
\end_inset

Le RMSE est sûrement un des critères les plus utilisés aujourd'hui (y compris
 pour les réseaux de neurones), cependant utiliser celui-ci reviendrait
 à considérer le ratio de la fréquence des réclamations comme étant distribué
 selon une loi gaussienne.
 Les résultats s'en trouvent alors biaisés car les propriétés statistiques
 de la variable expliquée ne sont pas prises en compte.
 Afin de palier à ce problème, un autre critère statistique sera utilisé
 : la déviance de Poisson.
 La déviance est utilisée la plupart du temps pour des tests d'hypothèses
 et elle joue un role important dans l'analyse des distributions de la famille
 exponentielle.
 Elle peut être vue comme une forme de distance (d'où son utilisation en
 temps que critère).
 Notons D* la déviance mise à l'échelle, un test entre les maximum de vraisembla
nce du modèle entrainé et du modèle saturé
\begin_inset Foot
status open

\begin_layout Plain Layout
Modèle où les 
\begin_inset Formula $\hat{y_{i}}$
\end_inset

sont définis comme les véritables valeurs 
\begin_inset Formula $y_{i},$
\end_inset

le maximum de vraisemblance de ce modèle est le meilleur que nous pouvons
 obtenir du fait que les 
\begin_inset Formula $y_{i}$
\end_inset

sont parfaitement prédits.
\end_layout

\end_inset

.
 Notons aussi 
\begin_inset Formula $l(\hat{y_{i})}$
\end_inset

 le log-vraisemblance de 
\begin_inset Formula $\hat{y_{i}}$
\end_inset

et 
\begin_inset Formula $l(y_{i})$
\end_inset

 le log-vraisemblance de 
\begin_inset Formula $y_{i}.$
\end_inset

 (wiki deviance)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D^{*}(y_{i},\hat{y_{i})}=2\left(l(y_{i})-l(\hat{y_{i})}\right)
\]

\end_inset


\begin_inset Newline newline
\end_inset

En utilisant la fonction de distribution des ED vue précédemment, le résultat
 suivant est obtenu :
\end_layout

\begin_layout Itemize
\begin_inset Formula $a'(\theta)=e^{\theta}$
\end_inset


\end_layout

\begin_layout Itemize
\begin_inset Formula $h(y)=ln(y)$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D^{*}(y_{i},\hat{y_{i})}=\frac{2}{\phi}v_{i}(y_{i}h(y_{i}))-a(h(y_{i}))-y_{i}h(\hat{y_{i}})+a(h(\hat{y_{i}})))
\]

\end_inset


\begin_inset Newline newline
\end_inset

La déviance non mise à l'échelle peut ensuite être obtenue en multipliant
 cette formule par le paramètre de dispersion 
\begin_inset Formula $\phi$
\end_inset

 (voir section 2.3.3).
 La dérivation de cette déviance non mise à l'échelle appliquée à la loi
 de poisson résulte en la déviance de Poisson non-mise à l'échelle, c'est
 ce critère qui sera utilisé pour l'apprentissage de nos modèles.
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D(y_{i},\hat{y_{i}})=2v_{i}(y_{i}ln(y_{i})-y_{i}ln(\hat{y_{i}})-y_{i}+\hat{y_{i}}),\:\;\forall y_{i}>0
\]

\end_inset


\begin_inset Newline newline
\end_inset

La base de donnée utilisée portant sur des événements rares, beaucoup de
 cas 
\begin_inset Formula $y_{i}=0$
\end_inset

 seront étudiés, en modifiant la formule ci dessus la formule adéquate pour
 ce cas particulier est donnée par :
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D(y_{i},\hat{y}_{i})=2v_{i}\hat{y_{i},}\;\:\forall y_{i}=0
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Overfit, AIC et BIC
\end_layout

\begin_layout Standard
Il est important de comprendre le but derrière la création d'un tel modèle.
 Nous cherchons à approximer une fonction de réponse 
\begin_inset Formula $Y$
\end_inset

 à l'aide de ce modèle.
 Afin que cette fonction sois au mieux approchée, il est important que le
 modèle reste général.
 En effet le but final du modèle est de prédire des valeurs de Y pour des
 nouvelles entrées 
\begin_inset Formula $X_{i}$
\end_inset

, ce qui amène à des méthodes permettant de vérifier que cette fonction
 est correctement approximée.
 Plus particulièrement nous chercons à éviter un maximum l'overfit.
 L'overfit survient lorsqu'un modèle approxime bien les valeurs du jeu de
 données utilisé pour l'entraînement mais que celui-ci est incapable de
 déterminer des valeurs cohérentes pour des nouvelles entrées, il peut être
 notamment causé par un trop grand nombre de variables explicatives ou une
 phase d'apprentissage mal configurée.
 Le modèle est alors inutilisable dans un scénario réél.
\begin_inset Newline newline
\end_inset

Afin de choisir des modèles limitant l'overfit, deux nouveaux critères seront
 introduits : AIC et BIC.
 Comme les autres critères vus, ce sont des mesures de la qualité d'un modèle
 statistique.
 Il est (presque) toujours possible d'améliorer les résultats d'un modèle
 sur les critères basiques en augmentant le nombre de variables explicatives.
 Cependant cette pratique augmente les risque d'overfit, c'est la raison
 pour laquelle dans la création d'un modèle la parcimonie
\begin_inset Foot
status open

\begin_layout Plain Layout
Principe consistant à utiliser le moins de variables explicatives possible
 pour expliquer un phénomène afin de réduire le phénomène d'overfit.
\end_layout

\end_inset

 du modèle est importante.
 Ces deux critères permettent de prendre en compte le nombre de variables
 explicatives dans le calcul de la qualité de modèle.
\end_layout

\begin_layout Itemize
AIC (Akaike Information Criterion) : (wiki aic) 
\begin_inset Formula $AIC=2k-2ln(L)$
\end_inset

 
\begin_inset Newline newline
\end_inset

(Où 
\begin_inset Formula $k$
\end_inset

 est le nombre de paramètres à estimer du modèle et L est le maximum de
 la fonction de vraisemblance du modèle (edit copyright))
\end_layout

\begin_layout Itemize
BIC (Bayesion Information Criterion) : (wiki) 
\begin_inset Formula $BIC=k\times ln(N)-2ln(L)$
\end_inset

 
\begin_inset Newline newline
\end_inset

(Où N est le nombre d'observations dans l'échantillon)
\end_layout

\begin_layout Subsubsection
Validation croisée (K-fold)
\end_layout

\begin_layout Standard
La valeur de certains paramètres d'un modèle pouvant être générée dans un
 premier temps de manière aléatoire lors de l'initialisation avant d'être
 optimisés, et la forme du jeu de données pouvant aussi influencer les résultats
, deux modèles 
\begin_inset Quotes eld
\end_inset

identiques
\begin_inset Quotes erd
\end_inset

 n'auront pas toujours le même résultats pour les critères statistiques
 utilisés.
 Il est aussi parfois difficile de détecter l'overfit, c'est la raison pour
 laquelle la validation croisée est utilisée.
 Généralement la base de données utilisée est divisée en un jeu d'entraînement
 et un jeu de test qui ne sera pas utilisé pour l'entraînement mais pour
 calculer les résultats du modèle aux différents critères statistiques.
 Dans le cas étudié ici, les événements sont rares, c'est pourquoi il est
 souvent préférable de travailler avec la base de donnée complète en évitant
 cette division.
 C'est pour palier à ce problème que la validation croisée sera utilisée.
\begin_inset Newline newline
\end_inset

Le principe de base est de diviser le jeu de données en 
\begin_inset Formula $K$
\end_inset

 ensembles de taille égale.
 Un modèle sera ensuite entrainé pour chaque ensemble en utilisant cet ensemble
 comme jeu de test et l'ensemble des autres ensembles comme jeu d'entraînement.
 Le résultat de la métrique est alors la moyenne des résultats des différents
 ensembles.
 Plus formellement :
\end_layout

\begin_layout Itemize
\begin_inset Formula $Q=\{(x_{1},y_{1}),...,(x_{n},y_{n})\}$
\end_inset

, la base de données.
\end_layout

\begin_layout Itemize
\begin_inset Formula $K$
\end_inset

, le nombre d'ensembles créés.
\end_layout

\begin_layout Itemize
\begin_inset Formula $M$
\end_inset

, l'algorithme d'apprentissage.
\end_layout

\begin_layout Itemize
\begin_inset Formula $E(.)$
\end_inset

, la fonction de perte dépendant de 
\begin_inset Formula $y$
\end_inset

 et 
\begin_inset Formula $\hat{y}$
\end_inset

.
\end_layout

\begin_layout Standard

\lang french
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset


\series bold
begin
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

Diviser 
\begin_inset Formula $Q$
\end_inset

 en 
\begin_inset Formula $K$
\end_inset

 sous-ensembles 
\begin_inset Formula $Q_{1},...,Q_{k}$
\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

for 
\begin_inset Formula $k=1,...,K$
\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

 test = 
\begin_inset Formula $Q_{k}$
\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

 train = 
\begin_inset Formula $Q\,\setminus\,Q_{k}$
\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

 
\begin_inset Formula $M_{k}=M(train)$
\end_inset

//Entraînement du modèle.
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

 
\begin_inset Formula $E_{k}=E(test)$
\end_inset

 //Erreur du modèle sur 
\begin_inset Formula $Q_{k}$
\end_inset

.
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

endfor
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset


\begin_inset Formula $E(Q)=K^{-1}\sum_{i=1}^{i=k}E_{k}$
\end_inset

//Moyenne des erreurs
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

return 
\begin_inset Formula $E(Q)$
\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
STATE 
\end_layout

\end_inset

 
\series bold
end
\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\lang french
\begin_inset Caption Standard

\begin_layout Plain Layout

\lang french
Validation croisée (K-folds)
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard

\lang french
\SpecialChar allowbreak
Cette méthode permet de limiter l'overfit et de le détecter dans la plupart
 des cas.
 La valeur de la métrique donnée par la validation croisée dispose d'une
 variance inférieure aux résultats donnés sans celle-ci.
 Comme dit précédemment la base de donnée est constituée d'événements rares
 et cette méthode sera donc préférée à la traditionnelle décomposition entrainem
ent/test.
\end_layout

\begin_layout Subsection
Réseaux de neurones
\end_layout

\end_body
\end_document
